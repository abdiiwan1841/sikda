SELECT $P{date1} as dt1, $P{date2} as dt2, V.KD_PUSKESMAS, V.NAMA_PUSKESMAS, I.KD_PENYAKIT, I.PENYAKIT,
COL1, COL2, COL3, COL4, COL5, COL6,
COL7, COL8, COL9, COL10, COL11, COL12,
TOTAL FROM (
SELECT 
V.KD_PUSKESMAS, V.NAMA_PUSKESMAS, V.KD_PENYAKIT,  
SUM(IF(UMURINDAYS>=0 AND UMURINDAYS<=7, 1,0)) AS `COL1`, 
SUM(IF(UMURINDAYS>=8 AND UMURINDAYS<=28, 1,0)) AS `COL2`, 
SUM(IF(UMURINDAYS>=29 AND UMURINDAYS<=365, 1,0)) AS `COL3`, 
SUM(IF(UMURINDAYS>=366 AND UMURINDAYS<=1460, 1,0)) AS `COL4`, 
SUM(IF(UMURINDAYS>=1461 AND UMURINDAYS<=3285, 1,0)) AS `COL5`, 
SUM(IF(UMURINDAYS>=3286 AND UMURINDAYS<=5110, 1,0)) AS `COL6`, 
SUM(IF(UMURINDAYS>=5111 AND UMURINDAYS<=6935, 1,0)) AS `COL7`, 
SUM(IF(UMURINDAYS>=6936 AND UMURINDAYS<=16060, 1,0)) AS `COL8`, 
SUM(IF(UMURINDAYS>=16061 AND UMURINDAYS<=19710, 1,0)) AS `COL9`, 
SUM(IF(UMURINDAYS>=19711 AND UMURINDAYS<=215353, 1,0)) AS `COL10`, 
SUM(IF(UMURINDAYS>=21536 AND UMURINDAYS<=25185, 1,0)) AS `COL11`, 
SUM(IF(UMURINDAYS>=25186, 1,0)) AS `COL12`, 
COUNT(V.KD_PELAYANAN) AS TOTAL 
FROM vw_rpt_penyakitpasien AS V
WHERE (TGL_PELAYANAN BETWEEN $P{date1} AND $P{date2}) AND KD_PUSKESMAS=$P{parameter1}
GROUP BY V.KD_PUSKESMAS, V.NAMA_PUSKESMAS,  
V.KD_PENYAKIT 
) V RIGHT JOIN mst_icd I ON I.KD_PENYAKIT=V.KD_PENYAKIT
ORDER BY I.KD_PENYAKIT, I.PENYAKIT;